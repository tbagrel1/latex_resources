\NeedsTeXFormat{LaTeX2e}

\ProvidesPackage{tbagrelmodel}[19/11/2016 - V2.0]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{xkeyval}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage{textcomp}
\RequirePackage{etoolbox}
\RequirePackage[frenchb]{babel}
\RequirePackage{setspace}
\RequirePackage{xcolor, color}
\RequirePackage{hyperref}
\RequirePackage{url}
\RequirePackage{eurosym}
\RequirePackage[normalem]{ulem}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{amscd}
\RequirePackage{amsxtra}
\RequirePackage{upref}
\RequirePackage[scr]{rsfso}
\RequirePackage[retainorgcmds]{IEEEtrantools}
\RequirePackage{graphicx}
\RequirePackage{caption}
\RequirePackage{pgf, pstricks, pst-plot, pst-text}
\RequirePackage{fancybox}
\RequirePackage[np]{numprint}
\RequirePackage{pgfornament}
\RequirePackage{tabularx}
\RequirePackage[siunitx, european]{circuitikz}
\RequirePackage{frcursive}
\RequirePackage{avant}
\RequirePackage{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\rmmodvalue}{nomod}
\newcommand{\sfmodvalue}{nomod}
\newcommand{\ttmodvalue}{nomod}

\newif\if@lmodern\@lmodernfalse
\newif\if@fourier\@fourierfalse
\newif\if@fouriert\@fouriertfalse
\newif\if@fourierenc\@fourierencfalse
\newif\if@fourierenct\@fourierenctfalse
\newif\if@mathptmx\@mathptmxfalse
\newif\if@mathptmxt\@mathptmxtfalse
\newif\if@mathpazo\@mathpazofalse
\newif\if@mathpazot\@mathpazotfalse
\newif\if@txfonts\@txfontsfalse
\newif\if@pxfonts\@pxfontsfalse
\newif\if@mathdesign\@mathdesignfalse
\newif\if@mathdesignt\@mathdesigntfalse
\newif\if@mathdesignc\@mathdesigncfalse
\newif\if@mathdesignct\@mathdesignctfalse
\newif\if@mathdesignu\@mathdesignufalse
\newif\if@mathdesignut\@mathdesignutfalse
\newif\if@kpfonts\@kpfontsfalse
\newif\if@kerkis\@kerkisfalse
\newif\if@lmr\@lmrfalse
\newif\if@lmfr\@lmfrfalse
\newif\if@lmfib\@lmfibfalse
\newif\if@lmdh\@lmdhfalse
\newif\if@put\@putfalse
\newif\if@pnc\@pncfalse
\newif\if@ptm\@ptmfalse
\newif\if@bch\@bchfalse
\newif\if@pbk\@pbkfalse
\newif\if@ppl\@pplfalse
\newif\if@pzc\@pzcfalse
\newif\if@lmss\@lmssfalse
\newif\if@phv\@phvfalse
\newif\if@phvs\@phvsfalse
\newif\if@pag\@pagfalse
\newif\if@lmtt\@lmttfalse
\newif\if@lmvtt\@lmvttfalse
\newif\if@pcr\@pcrfalse
\newif\if@rmmod\@rmmodfalse
\newif\if@sfmod\@sfmodfalse
\newif\if@ttmod\@ttmodfalse

\newif\if@rmd\@rmdfalse
\newif\if@sfd\@sfdfalse
\newif\if@ttd\@ttdfalse
\newif\if@sftd\@sftdfalse

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareOption{marges}{\geometry{margin=0.5cm}}
\DeclareOption{margess}{\geometry{margin=1cm}}
\DeclareOption{margesss}{\geometry{margin=1.5cm}}
\DeclareOption{margessss}{\geometry{margin=2cm}}
\DeclareOption{margesssss}{\geometry{margin=2.5cm}}
\DeclareOption{margessssss}{\geometry{margin=3cm}}

\DeclareOption{lmodern}{\@lmoderntrue}
\DeclareOption{fourier}{\@fouriertrue}
\DeclareOption{fouriert}{\@fourierttrue}
\DeclareOption{fourierenc}{\@fourierenctrue}
\DeclareOption{fourierenct}{\@fourierencttrue}
\DeclareOption{mathptmx}{\@mathptmxtrue}
\DeclareOption{mathptmxt}{\@mathptmxttrue}
\DeclareOption{mathpazo}{\@mathpazotrue}
\DeclareOption{mathpazot}{\@mathpazottrue}
\DeclareOption{txfonts}{\@txfontstrue}
\DeclareOption{pxfonts}{\@pxfontstrue}
\DeclareOption{mathdesign}{\@mathdesigntrue}
\DeclareOption{mathdesignt}{\@mathdesignttrue}
\DeclareOption{mathdesignc}{\@mathdesignctrue}
\DeclareOption{mathdesignct}{\@mathdesigncttrue}
\DeclareOption{mathdesignu}{\@mathdesignutrue}
\DeclareOption{mathdesignut}{\@mathdesignuttrue}
\DeclareOption{kpfonts}{\@kpfontstrue}
\DeclareOption{kerkis}{\@kerkistrue}
\DeclareOption{lmr}{\@lmrtrue}
\DeclareOption{lmfr}{\@lmfrtrue}
\DeclareOption{lmfib}{\@lmfibtrue}
\DeclareOption{lmdh}{\@lmdhtrue}
\DeclareOption{put}{\@puttrue}
\DeclareOption{pnc}{\@pnctrue}
\DeclareOption{ptm}{\@ptmtrue}
\DeclareOption{bch}{\@bchtrue}
\DeclareOption{pbk}{\@pbktrue}
\DeclareOption{ppl}{\@ppltrue}
\DeclareOption{pzc}{\@pzctrue}
\DeclareOption{lmss}{\@lmsstrue}
\DeclareOption{phv}{\@phvtrue}
\DeclareOption{phvs}{\@phvstrue}
\DeclareOption{pag}{\@pagtrue}
\DeclareOption{lmtt}{\@lmtttrue}
\DeclareOption{lmvtt}{\@lmvtttrue}
\DeclareOption{pcr}{\@pcrtrue}

\DeclareOption{rmd}{\@rmdtrue}
\DeclareOption{sfd}{\@sfdtrue}
\DeclareOption{ttd}{\@ttdtrue}
\DeclareOption{stfd}{\@sftdtrue}

\DeclareOption*{} % Ne rien faire quand une option est inconnue

\ProcessOptions

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{lmodern}

\if@lmr
\renewcommand{\rmmodvalue}{lmr}
\@rmmodtrue
\fi
\if@lmfr
\renewcommand{\rmmodvalue}{lmfr}
\@rmmodtrue
\fi
\if@lmfib
\renewcommand{\rmmodvalue}{lmfib}
\@rmmodtrue
\fi
\if@lmdh
\renewcommand{\rmmodvalue}{lmdh}
\@rmmodtrue
\fi
\if@put
\RequirePackage{utopia}
\renewcommand{\rmmodvalue}{put}
\@rmmodtrue
\fi
\if@pnc
\RequirePackage{newcent}
\renewcommand{\rmmodvalue}{pnc}
\@rmmodtrue
\fi
\if@ptm
\RequirePackage{txfonts}
\renewcommand{\rmmodvalue}{ptm}
\@rmmodtrue
\fi
\if@bch
\RequirePackage{charter}
\renewcommand{\rmmodvalue}{bch}
\@rmmodtrue
\fi
\if@pbk
\RequirePackage{bookman}
\renewcommand{\rmmodvalue}{pbk}
\@rmmodtrue
\fi
\if@ppl
\RequirePackage{pxfonts}
\renewcommand{\rmmodvalue}{ppl}
\@rmmodtrue
\fi
\if@pzc
\RequirePackage{chancery}
\renewcommand{\rmmodvalue}{pzc}
\@rmmodtrue
\fi

\if@lmss
\renewcommand{\sfmodvalue}{lmss}
\@sfmodtrue
\fi
\if@phv
\RequirePackage{helvet}
\renewcommand{\sfmodvalue}{phv}
\@sfmodtrue
\fi
\if@phvs
\RequirePackage[scaled]{helvet}
\renewcommand{\sfmodvalue}{phvs}
\@sfmodtrue
\fi
\if@pag
\RequirePackage{avant}
\renewcommand{\sfmodvalue}{pag}
\@sfmodtrue
\fi

\if@lmtt
\renewcommand{\ttmodvalue}{lmtt}
\@ttmodtrue
\fi
\if@lmvtt
\renewcommand{\ttmodvalue}{lmvtt}
\@ttmodtrue
\fi
\if@pcr
\RequirePackage{courier}
\renewcommand{\ttmodvalue}{pcr}
\@ttmodtrue
\fi

\if@lmodern
\fi
\if@fourier
\RequirePackage{fourier}
\fi
\if@fouriert
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage{fourier}
\fi
\if@fourierenc
\RequirePackage{fourierenc}
\fi
\if@fourierenct
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage{fourierenc}
\fi
\if@mathptmx
\RequirePackage{mathptmx}
\fi
\if@mathptmxt
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage{mathptmx}
\fi
\if@mathpazo
\RequirePackage{mathpazo}
\fi
\if@mathpazot
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage{mathpazo}
\fi
\if@txfonts
\RequirePackage{txfonts}
\fi
\if@pxfonts
\RequirePackage{pxfonts}
\fi
\if@mathdesign
\RequirePackage{mathdesign}
\fi
\if@mathdesignt
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage{mathdesign}
\fi
\if@mathdesignc
\RequirePackage[charter]{mathdesign}
\fi
\if@mathdesignct
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage[charter]{mathdesign}
\fi
\if@mathdesignu
\RequirePackage[utopia]{mathdesign}
\fi
\if@mathdesignut
\RequirePackage[scaled]{helvet}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}
\RequirePackage[utopia]{mathdesign}
\fi
\if@kpfonts
\RequirePackage{kpfonts}
\fi
\if@kerkis
\RequirePackage{kmath}
\RequirePackage{kerkis}
\fi

\if@rmmod
\renewcommand{\rmdefault}{\rmmodvalue}
\fi
\if@sfmod
\renewcommand{\sfdefault}{\sfmodvalue}
\fi
\if@ttmod
\renewcommand{\ttdefault}{\ttmodvalue}
\fi

\if@rmd
\renewcommand{\familydefault}{\rmdefault}
\fi
\if@sfd
\renewcommand{\familydefault}{\sfdefault}
\fi
\if@ttd
\renewcommand{\familydefault}{\ttdefault}
\fi
\if@sftd
\renewcommand{\familydefault}{\sftdefault}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Raccourcis
\newenvironment{Ie}{\IEEEeqnarray}{\endIEEEeqnarray}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Famille police SFT
\newcommand{\sftdefault}{pag}
\newcommand{\sftfamily}{\fontfamily{\sftdefault}\selectfont}
\newcommand{\textsft}[1]{{\fontfamily{\sftdefault}\selectfont #1}}

% Opérateurs mathématiques
\DeclareMathOperator{\Arcsin}{Arcsin}
\DeclareMathOperator{\Arccos}{Arccos}
\DeclareMathOperator{\Arctan}{Arctan}

% Commande de tabulation
\newcommand{\tab}{\hspace{1cm}}       % Tabulation

% Commandes ensembles math
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Rb}{\mathbf{R}}
\newcommand{\Nb}{\mathbf{N}}
\newcommand{\Db}{\mathbf{D}}
\newcommand{\Zb}{\mathbf{Z}}
\newcommand{\Qb}{\mathbf{Q}}
\newcommand{\Cb}{\mathbf{C}}

% Commande vecteur
\newcommand{\lvec}[1]{\mathchoice%
{\overrightarrow{\displaystyle\mathstrut#1\,\,}}%
{\overrightarrow{\textstyle\mathstrut#1\,\,}}%
{\overrightarrow{\scriptstyle\mathstrut#1\,\,}}%
{\overrightarrow{\scriptscriptstyle\mathstrut#1\,\,}}}

% Pour les environnements enumerate
\renewcommand{\theenumi}{\textbf{\arabic{enumi}}}
\renewcommand{\labelenumi}{\textbf{\theenumi.}}
\renewcommand{\theenumii}{\textbf{\alph{enumii}}}
\renewcommand{\labelenumii}{\textbf{\theenumii.}}

% Vecteurs i et j en maths
\newcommand{\veci}{\vec{\imath}}
\newcommand{\vecj}{\vec{\jmath}}

% Operateurs en maths
\renewcommand{\u}[1]{\,\mathrm{#1}}
\newcommand{\dx}{\mathrm{d}x}
\newcommand{\dt}{\mathrm{d}t}
\newcommand{\dy}{\mathrm{d}y}
\newcommand{\di}[1]{\mathrm{d}#1}
\newcommand{\EE}[1]{\cdot 10^{#1}}
\renewcommand{\no}[1]{n\textsuperscript{o}#1}
\newcommand{\dC}{\degres{}\mathrm{C}}

% Commande restriction maths
\renewcommand{\restriction}[2]{\mathchoice
              {\setbox1\hbox{${\displaystyle #1}_{\scriptstyle #2}$}
              \restrictionaux{#1}{#2}}
              {\setbox1\hbox{${\textstyle #1}_{\scriptstyle #2}$}
              \restrictionaux{#1}{#2}}
              {\setbox1\hbox{${\scriptstyle #1}_{\scriptscriptstyle #2}$}
              \restrictionaux{#1}{#2}}
              {\setbox1\hbox{${\scriptscriptstyle #1}_{\scriptscriptstyle #2}$}
              \restrictionaux{#1}{#2}}}
\newcommand{\restrictionaux}[2]{{#1\,\smash{\vrule height .8\ht1 depth .85\dp1}}_{\,#2}}

% Il existe et pour tout et ssi
\newcommand{\ilexiste}[2]{\text{il existe }#1 \in #2 \text{ tel que }}
\newcommand{\pourtout}[2]{\text{pour tout }#1 \in #2,\:}
\newcommand{\ssi}{\text{ si et seulement si }}

% Ensemble solution
\renewcommand{\S}{\mathscr{S}}

% Commande limite
\newcommand{\lims}{\lim\limits}

% Commande \intertext dans les environnements IEEEeqnarray
\makeatletter
\patchcmd{\@IEEEeqnarray}{\relax}{\relax\intertext@}{}{}
\makeatother

% En-tête personnalisé et boîtes de titre
\newcommand{\entete}[5]{{#5
\noindent\sc{#1} \hfill pour le #3 \\
#2 \hfill #4}}
\newcommand{\ovaltitre}[4]{\begin{center}
\cornersize*{6mm}
\Ovalbox{\begin{minipage}{#2}
\vspace{#3}{
  \begin{center}
  \sftfamily #4
  #1
  \end{center}}
\vspace{#3}
\end{minipage}}
\end{center}}
\newcommand{\ovalappreciations}[5]{\begin{center}
\cornersize*{6mm}
\Ovalbox{\begin{minipage}{\textwidth}
\vspace{#4}{
  \sftfamily #5
  \vspace{0.4cm}
  \hspace{1cm}\bf{#1}\hfill\bf{#2}\hspace{1cm}\vspace{#3}}
\vspace{#4}
\end{minipage}}
\end{center}}
\newcommand{\orn}[2]{\begin{center}
\pgfornament[width=#2]{#1}
\end{center}}

% Commande circuit
\newcommand{\circuit}[3]{\shorthandoff{:!}
\begin{minipage}{\linewidth}
\begin{center}
\begin{tikzpicture}[scale=#2]
#1
\end{tikzpicture}
\captionof{figure}{#3}
\end{center}
\end{minipage}
\shorthandon{:!}}

% Raccourcis
\newcommand{\tn}[1]{\textnormal{#1}}
\newcommand{\ep}[1]{\emph{#1}}
\renewcommand{\up}[1]{\textup{#1}}
\renewcommand{\sl}[1]{\textsl{#1}}
\renewcommand{\sc}[1]{\textsc{#1}}
\renewcommand{\it}[1]{\textit{#1}}
\newcommand{\md}[1]{\textmd{#1}}
\renewcommand{\bf}[1]{\textbf{#1}}
\renewcommand{\rm}[1]{\textrm{#1}}
\renewcommand{\sf}[1]{\textsf{#1}}
\renewcommand{\tt}[1]{\texttt{#1}}
\newcommand{\sft}[1]{\textsft{#1}}
\newcommand{\mtn}[1]{\mathnormal{#1}}
\newcommand{\mrm}[1]{\mathrm{#1}}
\newcommand{\msf}[1]{\mathsf{#1}}
\newcommand{\mtt}[1]{\mathtt{#1}}
\newcommand{\mbf}[1]{\mathbf{#1}}
\renewcommand{\mit}[1]{\mathit{#1}}
\newcommand{\mbb}[1]{\mathbb{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\mca}[1]{\mathcala{#1}}
\newcommand{\mcb}[1]{\mathcalb{#1}}
\newcommand{\mcc}[1]{\mathcalc{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Définition des vecteurs
\let\svec\vec
% Choix vecteur par défaut
\let\vec\lvec
% \let\vec\svec

% Définition des alphabets caligraphiques
\let\mathcala\mathscr
\let\mathcalb\mathcal
\let\mathcalc\mathfrak
% Alphabet caligraphique par défaut
\let\mathcal\mathcala
% \let\mathcal\mathcalb
% \let\mathcal\mathcalc

% Définition des variantes de phi
\let\lphi\phi
\let\vphi\varphi
% Choix variante de phi par défaut
\let\phi\vphi

% Définition des variantes de epsilon
\let\lepsilon\epsilon
\let\vepsilon\varepsilon
% Choix variante de epsilon par défaut
\let\epsilon\vepsilon
% \let\epsilon\lepsilon

% Définition des fractions
\let\sfrac\frac
\let\lfrac\dfrac
% Choix fraction par défaut
\let\frac\sfrac
% \let\frac\dfrac

% Définition des iff
\let\liff\iff
\let\siff\Leftrightarrow
% Choix iff par défaut
\let\iff\liff
% \let\iff\siff

% Définition des [l|g]eqslant
\let\rleq\leq
\let\rgeq\geq
\let\sleq\leqslant
\let\sgeq\geqslant
% Choix [l|g]eqslant par défaut
\let\leq\rleq
\let\geq\rgeq
% \let\leq\sleq
% \let\geq\sgeq

% Raccourcis
\let\lto\longrightarrow
\let\lsto\longmapsto
\let\non\nonumber
\let\wh\widehat
\let\noi\noindent
\let\x\times
\let\cd\cdot
\let\tss\textsuperscript

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
